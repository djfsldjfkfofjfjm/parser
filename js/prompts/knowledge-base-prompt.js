/**
 * Модуль с промптом для создания базы знаний
 */

/**
 * Параметры оформления для промпта базы знаний
 * @type {Object}
 */
export const knowledgeBasePromptConfig = {
    // Глубина детализации информации: от 1 (минимальная) до 5 (максимальная)
    detalizationLevel: 5,
    
    // Структурировать информацию по категориям товаров
    categorizeByProducts: true,
    
    // Включить информацию о ценах
    includePrices: true,
    
    // Включить ссылки на продукты
    includeLinks: true,
    
    // Добавлять маркеры для выделения важной информации
    useEmphasisMarkers: true,
    
    // Формат вывода
    outputFormat: 'structured' // 'structured', 'simple', 'markdown'
};

/**
 * Создает промпт для формирования базы знаний
 * 
 * @param {Object} config - Конфигурационные параметры
 * @returns {string} - Промпт для Gemini API
 */
export function buildKnowledgeBasePrompt(config = knowledgeBasePromptConfig) {
    // Настройки маркеров выделения
    const emphasisMarkers = {
        start: config.useEmphasisMarkers ? '**' : '',
        end: config.useEmphasisMarkers ? '**' : ''
    };
    
    // Настройки формата вывода
    let formatOptions = '';
    switch(config.outputFormat) {
        case 'structured':
            formatOptions = `
Организуй информацию по категориям с четкой иерархией.
Используй заголовки, подзаголовки и списки для лучшей читаемости.
Структурируй информацию по следующему формату:
1. КАТЕГОРИЯ ТОВАРОВ (заглавными буквами)
   - Подкатегория (если есть)
     * Название товара: описание, характеристики, цена
     * Ссылка на товар: URL
`;
            break;
        case 'markdown':
            formatOptions = `
Используй Markdown для структурирования:
# КАТЕГОРИЯ
## Подкатегория
* **Товар** - характеристики, цена
* URL: [Ссылка на товар](url)
`;
            break;
        case 'simple':
            formatOptions = `
Используй простой текстовый формат с минимальным форматированием.
Разделяй секции пустыми строками, товары нумеруй.
`;
            break;
    }
    
    // Настройки уровня детализации
    const detailLevel = 'ПОЛНОЙ и ТОЧНОЙ с ценами на продукцию и ссылками на страницы';
    
    // Составляем итоговый промпт
    return `
Создай полную и детальную структурированную базу знаний о компании и ее продуктах на основе предоставленной информации. 
Сохрани ВСЕ продукты компании в наличии с их полными характеристиками, кратким описанием и ЦЕНАМИ, и ссылками на конкретные страницы продуктов (чтобы отправлять потом клиентам).
Организуй информацию так, чтобы затем легко эту базу знаний добавить ИИ-чат-боту в инструкцию (он будет продавать продукты компании).
Сделай акцент на продуктах компании.
Эта База знаний далее будет добавлена в Инструкцию Чат-бота компании, поэтому очень важно, чтобы она была максимально детальна.
ЛЮБЫЕ твои комментарии - ЗАПРЕЩЕНЫ!
`;
}

/**
 * Экспортируем готовый промпт
 */
export const knowledgeBasePrompt = buildKnowledgeBasePrompt();

export default knowledgeBasePrompt; 